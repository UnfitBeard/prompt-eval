<div class="rounded-xl border border-gray-200 bg-white p-4">
  <div class="mb-3 flex items-center justify-between">
    <h2 class="font-semibold text-gray-900">Your Learning Overview</h2>
    <span class="text-xs text-gray-500" *ngIf="summary">Level {{ summary.level | titlecase }}</span>
  </div>

  <ng-container *ngIf="loading; else contentTpl">
    <div class="py-6 text-center text-sm text-gray-500">Calculating statistics...</div>
  </ng-container>

  <ng-template #contentTpl>
    <ng-container *ngIf="summary && stats; else emptyTpl">
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm">
        <div class="rounded-lg bg-gray-50 px-3 py-2">
          <div class="text-xs text-gray-500">Course completion</div>
          <div class="mt-1 text-xl font-semibold text-gray-900">
            {{ stats.completionRate | number: '1.0-0' }}%
          </div>
          <div class="mt-1 text-xs text-gray-500">
            {{ summary.completed_courses }}/{{ summary.total_courses }} courses completed
          </div>
        </div>

        <div class="rounded-lg bg-gray-50 px-3 py-2">
          <div class="text-xs text-gray-500">Average course progress</div>
          <div class="mt-1 text-xl font-semibold text-gray-900">
            {{ stats.averageCourseProgress | number: '1.0-0' }}%
          </div>
          <div class="mt-1 text-xs text-gray-500">
            {{ stats.totalLessonsCompleted }}/{{ stats.totalLessons }} lessons completed
          </div>
        </div>

        <div class="rounded-lg bg-gray-50 px-3 py-2">
          <div class="text-xs text-gray-500">XP towards next level</div>
          <div class="mt-1 text-xl font-semibold text-gray-900">
            {{ stats.xpProgressToNextLevel | number: '1.0-0' }}%
          </div>
          <div class="mt-2 h-1.5 rounded-full bg-gray-200 overflow-hidden">
            <div
              class="h-1.5 rounded-full bg-indigo-500"
              [style.width.%]="stats.xpProgressToNextLevel"
            ></div>
          </div>
        </div>
      </div>

      <div class="mt-4 flex flex-wrap items-center gap-4 text-xs text-gray-600">
        <span>Total XP: <span class="font-semibold">{{ summary.total_xp }}</span></span>
        <span>Current streak: <span class="font-semibold">{{ summary.streak_days }}</span> days</span>
      </div>
    </ng-container>
  </ng-template>

  <ng-template #emptyTpl>
    <div class="py-6 text-center text-sm text-gray-500">
      No progress data yet. Once you start lessons, your statistics will appear here.
    </div>
  </ng-template>
</div>
